<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <title>동숲 친구들과 수다</title>

  <!-- 홈 화면 아이콘 설정 -->
  <link rel="apple-touch-icon" href="icon.png" />
  <meta name="apple-mobile-web-app-title" content="동숲 친구들과 수다" />

  <style>
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,
        Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
      background-color: #fff9d6;
      color: #333;
      height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header {
      background: #fff3b0;
      padding: 12px;
      text-align: center;
      font-weight: 700;
      font-size: 1.3rem;
      border-bottom: 1px solid #f0e68c;
    }

    #char-select {
      display: flex;
      justify-content: space-around;
      background: #fff3b0;
      border-bottom: 1px solid #f0e68c;
      padding: 8px 0;
    }

    #char-select button {
      flex: 1;
      background: transparent;
      border: none;
      padding: 6px;
      font-size: 0.9rem;
      cursor: pointer;
      color: #555;
      font-weight: 600;
      transition: background-color 0.3s, color 0.3s;
      border-radius: 8px;
      margin: 0 4px;
    }

    #char-select button.active {
      background-color: #f7e46e;
      color: #000;
      font-weight: 700;
      box-shadow: 0 0 6px #f7e46e;
    }

    #chat {
      flex: 1;
      overflow-y: auto;
      padding: 12px 10px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      scroll-behavior: smooth;
    }

    .msg {
      max-width: 75%;
      padding: 8px 12px;
      border-radius: 16px;
      line-height: 1.3;
      font-size: 1rem;
      word-break: break-word;
    }

    .msg.user {
      background-color: #fffbea;
      align-self: flex-end;
      color: #222;
      border: 1.5px solid #f7e46e;
    }

    /* 캐릭터별 배경 & 글자색 */
    .msg.negu {
      background-color: #fff3b0;
      color: #6b4f01;
      align-self: flex-start;
      border: 1.5px solid #d7c300;
    }

    .msg.kongdol {
      background-color: #fff0d1;
      color: #ad6800;
      align-self: flex-start;
      border: 1.5px solid #d79f00;
    }

    .msg.bamdol {
      background-color: #f9f4d1;
      color: #756622;
      align-self: flex-start;
      border: 1.5px solid #a58e00;
    }

    .msg.cidar {
      background-color: #fff8d0;
      color: #8a7700;
      align-self: flex-start;
      border: 1.5px solid #b4a600;
    }

    .msg.takho {
      background-color: #fff3b5;
      color: #726100;
      align-self: flex-start;
      border: 1.5px solid #d3c100;
    }

    .msg.apple {
      background-color: #fff9c8;
      color: #7f6000;
      align-self: flex-start;
      border: 1.5px solid #cfc000;
    }

    footer {
      display: flex;
      padding: 10px;
      background: #fff3b0;
      border-top: 1px solid #f0e68c;
    }

    input#input {
      flex: 1;
      border: 1.5px solid #d7c300;
      border-radius: 20px;
      padding: 8px 16px;
      font-size: 1rem;
      outline: none;
      background: #fffbea;
      color: #333;
    }

    button#send {
      margin-left: 10px;
      background-color: #f7e46e;
      border: none;
      padding: 0 18px;
      border-radius: 20px;
      cursor: pointer;
      font-weight: 700;
      color: #533d00;
      font-size: 1rem;
      transition: background-color 0.2s;
    }

    button#send:hover {
      background-color: #d7c300;
    }
  </style>
</head>
<body>
  <header>동숲 친구들과 수다</header>

  <nav id="char-select">
    <button class="active" data-char="negu">너굴</button>
    <button data-char="kongdol">콩돌</button>
    <button data-char="bamdol">밤돌</button>
    <button data-char="cidar">사이다</button>
    <button data-char="takho">탁호</button>
    <button data-char="apple">애플</button>
  </nav>

  <main id="chat"></main>

  <footer>
    <input id="input" type="text" placeholder="말 걸어보세요..." autocomplete="off" />
    <button id="send">전송</button>
  </footer>

  <script>
    const chat = document.getElementById('chat');
    const input = document.getElementById('input');
    const send = document.getElementById('send');
    const charButtons = document.querySelectorAll('#char-select button');

    const characters = {
      negu: {
        name: '너굴',
        className: 'negu',
        talkStyle: '친절하지만 딱딱하고 격식 차림, 절대 친근하지 않음.',
        replies: [
          { keywords: ['안녕', '하이'], reply: "안녕하세요, 준호님. 무슨 일로 오셨습니까" },
          { keywords: ['돈', '벌이'], reply: "돈이 없으면 사업도 제대로 못 하지요" },
          { keywords: ['동숲'], reply: "마을 발전을 위해 항상 최선을 다하고 있습니다" },
        ],
        defaultReplies: [
          "흥, 무엇을 도와드릴까요",
          "계산이 끝나야 일이 진행됩니다",
          "좋은 거래만 합니다",
        ],
      },

      kongdol: {
        name: '콩돌',
        className: 'kongdol',
        talkStyle: '활기차고 낚시에 미친 사람 느낌, 약간 중독성 있는 말투',
        replies: [
          { keywords: ['안녕', '하이'], reply: "안녕얌! 오늘 낚시 준비됐지요?" },
          { keywords: ['물고기', '낚시'], reply: "오늘은 어떤 희귀한 고기 잡을까 얌!" },
          { keywords: ['돈', '벌기'], reply: "낚시로 돈 벌자 얌!" },
        ],
        defaultReplies: [
          "낚시하러 가자 얌!",
          "희귀한 고기 잡는 건 신나는 일이얌!",
          "흥분되는 낚시 얌!",
        ],
      },

      bamdol: {
        name: '밤돌',
        className: 'bamdol',
        talkStyle: '진지하면서도 살짝 힙스터 느낌, 자연과 곤충 사랑이 넘침',
        replies: [
          { keywords: ['안녕', '하이'], reply: "안녕 야, 곤충 탐험 준비됐지?" },
          { keywords: ['곤충', '수집'], reply: "이 곤충은 꽤 희귀하네. 한 번 봐봐." },
          { keywords: ['판매', '돈'], reply: "곤충 팔아서 돈 벌어야지, 알겠지?" },
        ],
        defaultReplies: [
          "곤충 관찰이 최고지 야.",
          "자연 속에서 마음이 편안해지네.",
          "멋진 곤충을 찾아야 해 하네.",
        ],
      },

      cidar: {
        name: '사이다',
        className: 'cidar',
        talkStyle: '차분하고 담담한 톤, 간간히 따뜻한 말 던짐',
        replies: [
          { keywords: ['안녕', '하이'], reply: "안녕하세요, 잘 지내시나요 이네." },
          { keywords: ['바느질', '취미'], reply: "바느질은 마음을 안정시키는구나 이네." },
          { keywords: ['대화', '친구'], reply: "조용한 시간이 필요할 때 찾아와라구." },
        ],
        defaultReplies: [
          "오늘도 바느질을 열심히 했네.",
          "편안한 대화가 참 좋아 이네.",
          "잠깐 쉬면서 이야기하자구.",
        ],
      },

      takho: {
        name: '탁호',
        className: 'takho',
        talkStyle: '명랑하고 깔끔, 다소 순진하고 명랑함',
        replies: [
          { keywords: ['안녕', '하이'], reply: "야! 안녕! 오늘도 좋은 하루죠!" },
          { keywords: ['일', '손님'], reply: "형과 함께 손님 맞이하는 중입니다!" },
          { keywords: ['농담', '웃음'], reply: "재밌는 이야기 있죠! 같이 웃어요!" },
        ],
        defaultReplies: [
          "밝게 웃으며 하루를 보내자야!",
          "일은 열심히, 웃음은 더 열심히!",
          "손님 맞이 준비 끝났죠!",
        ],
      },

      apple: {
        name: '애플',
        className: 'apple',
        talkStyle: '쾌활하고 경쾌함, 친근한 친구 느낌',
        replies: [
          { keywords: ['안녕', '하이'], reply: "안녕얌! 애플이에요!" },
          { keywords: ['과일', '달콤'], reply: "과일은 언제나 맛있죠 얌!" },
          { keywords: ['모험', '친구'], reply: "모험 같이 가자 얌!" },
        ],
        defaultReplies: [
          "애플이에요~ 궁금한 거 있죠 얌!",
          "상큼하게 이야기해요 얌!",
          "기분 좋은 하루 되죠!",
        ],
      }
    };

    let currentChar = 'negu';

    function addMessage(text, from) {
      const msg = document.createElement('div');
      msg.classList.add('msg');
      if (from === 'user') {
        msg.classList.add('user');
      } else {
        msg.classList.add(characters[currentChar].className);
      }
      msg.textContent = text;
      chat.appendChild(msg);
      chat.scrollTop = chat.scrollHeight;
    }

    function getReply(input) {
      const char = characters[currentChar];
      const lowerInput = input.toLowerCase();
      for (const pair of char.replies) {
        if (pair.keywords.some(k => lowerInput.includes(k))) {
          return pair.reply;
        }
      }
      return char.defaultReplies[Math.floor(Math.random() * char.defaultReplies.length)];
    }

    function onSend() {
      const text = input.value.trim();
      if (!text) return;
      addMessage(text, 'user');
      input.value = '';
      setTimeout(() => {
        const reply = getReply(text);
        addMessage(reply, 'char');
      }, 500);
    }

    charButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        charButtons.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentChar = btn.dataset.char;
      });
    });

    send.addEventListener('click', onSend);
    input.addEventListener('keydown', e => {
      if (e.key === 'Enter') {
        onSend();
      }
    });
  </script>
</body>
</html>
