<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>í…Œë§ˆ ë³€ê²½ íŒì—…</title>
    <style>
        /*
         * ê¸°ë³¸ ìŠ¤íƒ€ì¼
         */
        body {
            margin: 0;
            padding: 40px 0;
            background-color: var(--bg-color, #f0f0f0); /* í…Œë§ˆ ìƒ‰ìƒ ë³€ìˆ˜ ì‚¬ìš© */
            font-family: 'Segoe UI', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            transition: background-color 0.5s ease; /* ë°°ê²½ìƒ‰ ì „í™˜ ì• ë‹ˆë©”ì´ì…˜ */
        }

        h1 {
            font-size: 32px;
            margin-bottom: 30px;
            color: var(--heading-color, #003566); /* í…Œë§ˆ ìƒ‰ìƒ ë³€ìˆ˜ ì‚¬ìš© */
            text-align: center;
            transition: color 0.5s ease; /* ì œëª©ìƒ‰ ì „í™˜ ì• ë‹ˆë©”ì´ì…˜ */
        }

        /*
         * ê·¸ë¦¬ë“œ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼
         */
        .grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            width: 320px;
            max-width: 90%;
            margin-bottom: 20px;
        }

        /*
         * ê° ë²„íŠ¼ ì…€ ìŠ¤íƒ€ì¼
         */
        .cell {
            background-color: var(--button-color, #74c0fc); /* í…Œë§ˆ ìƒ‰ìƒ ë³€ìˆ˜ ì‚¬ìš© */
            border-radius: 15px;
            aspect-ratio: 1 / 1;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            font-weight: bold;
            color: var(--button-text-color, #fff); /* í…Œë§ˆ ìƒ‰ìƒ ë³€ìˆ˜ ì‚¬ìš© */
            cursor: pointer;
            transition: transform 0.3s ease, background-color 0.3s ease, color 0.3s ease; /* ì „í™˜ ì• ë‹ˆë©”ì´ì…˜ ì¶”ê°€ */
            user-select: none;
        }

        .cell:hover {
            transform: translateY(-3px);
            background-color: var(--button-hover-color, #4da6ed); /* í…Œë§ˆ ìƒ‰ìƒ ë³€ìˆ˜ ì‚¬ìš© */
        }

        .cell:active {
            transform: translateY(0);
            background-color: var(--button-active-color, #2b7bc0); /* í…Œë§ˆ ìƒ‰ìƒ ë³€ìˆ˜ ì‚¬ìš© */
        }

        /*
         * í…Œë§ˆ ë²„íŠ¼ ìŠ¤íƒ€ì¼
         */
        .theme-button {
            width: 320px;
            max-width: 90%;
            padding: 15px 20px;
            background-color: var(--theme-button-color, #fca311); /* í…Œë§ˆ ìƒ‰ìƒ ë³€ìˆ˜ ì‚¬ìš© */
            color: var(--theme-button-text-color, #fff); /* í…Œë§ˆ ìƒ‰ìƒ ë³€ìˆ˜ ì‚¬ìš© */
            font-size: 20px;
            font-weight: bold;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            transition: background-color 0.3s ease, transform 0.3s ease, color 0.3s ease; /* ì „í™˜ ì• ë‹ˆë©”ì´ì…˜ ì¶”ê°€ */
            text-align: center;
        }

        .theme-button:hover {
            background-color: var(--theme-button-hover-color, #fb8b24); /* í…Œë§ˆ ìƒ‰ìƒ ë³€ìˆ˜ ì‚¬ìš© */
            transform: translateY(-2px);
        }

        .theme-button:active {
            background-color: var(--theme-button-active-color, #e57100); /* í…Œë§ˆ ìƒ‰ìƒ ë³€ìˆ˜ ì‚¬ìš© */
            transform: translateY(0);
        }

        /*
         * ì¼ë°˜ íŒì—… ì˜¤ë²„ë ˆì´ ìŠ¤íƒ€ì¼
         */
        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .popup-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        /*
         * ì¼ë°˜ íŒì—… ë‚´ìš© ìŠ¤íƒ€ì¼
         */
        .popup-content {
            background-color: #fff;
            border-radius: 20px;
            padding: 30px;
            width: 300px;
            max-width: 90%;
            text-align: center;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
            position: relative;
            transform: scale(0.7);
            transition: transform 0.3s ease, opacity 0.3s ease;
            opacity: 0;
        }

        .popup-overlay.show .popup-content {
            transform: scale(1);
            opacity: 1;
        }

        .popup-content h2 {
            margin-top: 0;
            color: #003566;
            font-size: 28px;
        }

        .popup-content p {
            color: #333;
            font-size: 18px;
            line-height: 1.5;
        }

        /*
         * ì¼ë°˜ íŒì—… ë‹«ê¸° ë²„íŠ¼ ìŠ¤íƒ€ì¼
         */
        .close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 36px;
            height: 36px;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #e74c3c;
            border-radius: 8px;
            font-size: 24px;
            color: #fff;
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.1s ease;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .close-btn:hover {
            background-color: #c0392b;
            transform: translateY(-1px);
        }

        .close-btn:active {
            background-color: #a32c21;
            transform: translateY(0);
        }

        /*
         * í…Œë§ˆ íŒì—… ìŠ¤íƒ€ì¼
         */
        .theme-popup-content {
            background-color: var(--popup-bg-color, #fff); /* í…Œë§ˆ ìƒ‰ìƒ ë³€ìˆ˜ ì‚¬ìš© */
            border-radius: 20px;
            padding: 30px;
            width: 350px;
            max-width: 90%;
            max-height: 80vh;
            text-align: center;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.25);
            position: relative;
            display: flex;
            flex-direction: column;
            transform: scale(0.7);
            transition: transform 0.3s ease, opacity 0.3s ease, background-color 0.5s ease; /* ì „í™˜ ì• ë‹ˆë©”ì´ì…˜ ì¶”ê°€ */
            opacity: 0;
            box-sizing: border-box;
        }

        .popup-overlay.show .theme-popup-content {
            transform: scale(1);
            opacity: 1;
        }

        .theme-popup-content h2 {
            margin-top: 0;
            color: var(--popup-heading-color, #003566); /* í…Œë§ˆ ìƒ‰ìƒ ë³€ìˆ˜ ì‚¬ìš© */
            font-size: 28px;
            margin-bottom: 20px;
            transition: color 0.5s ease; /* ì „í™˜ ì• ë‹ˆë©”ì´ì…˜ ì¶”ê°€ */
        }

        /*
         * ìŠ¤í¬ë¡¤ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ (ìŠ¤í¬ë¡¤ë°” ë³´ì´ê²Œ)
         */
        .theme-scroll-container {
            flex-grow: 1;
            overflow-y: scroll; /* 'scroll'ë¡œ ë³€ê²½í•˜ì—¬ ìŠ¤í¬ë¡¤ë°” í•­ìƒ ë³´ì´ê²Œ */
            padding-right: 15px; /* ìŠ¤í¬ë¡¤ë°” ê³µê°„ í™•ë³´ */
            box-sizing: border-box; /* íŒ¨ë”© í¬í•¨ í¬ê¸° ê³„ì‚° */
        }

        /* ì›¹í‚· ê¸°ë°˜ ë¸Œë¼ìš°ì € ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ */
        .theme-scroll-container::-webkit-scrollbar {
            width: 8px; /* ìŠ¤í¬ë¡¤ë°” ë„ˆë¹„ */
            background-color: var(--scrollbar-track-color, #f1f1f1); /* ìŠ¤í¬ë¡¤ë°” íŠ¸ë™ ìƒ‰ìƒ */
            border-radius: 4px;
        }

        .theme-scroll-container::-webkit-scrollbar-thumb {
            background-color: var(--scrollbar-thumb-color, #888); /* ìŠ¤í¬ë¡¤ë°” ìƒ‰ìƒ */
            border-radius: 4px;
            transition: background-color 0.3s ease;
        }

        .theme-scroll-container::-webkit-scrollbar-thumb:hover {
            background-color: var(--scrollbar-thumb-hover-color, #555); /* ìŠ¤í¬ë¡¤ë°” í˜¸ë²„ ìƒ‰ìƒ */
        }


        /*
         * í…Œë§ˆ ì•„ì´í…œ ìŠ¤íƒ€ì¼ (ìœ„, ì¤‘ê°„, ì•„ë˜ í¬ê¸° ì¡°ì ˆ)
         */
        .theme-item {
            padding: 15px;
            margin-bottom: 10px;
            background-color: var(--theme-item-bg-color, #e0f2f7); /* í…Œë§ˆ ìƒ‰ìƒ ë³€ìˆ˜ ì‚¬ìš© */
            border-radius: 10px;
            font-size: 18px;
            color: var(--theme-item-text-color, #003566); /* í…Œë§ˆ ìƒ‰ìƒ ë³€ìˆ˜ ì‚¬ìš© */
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.1s ease, font-size 0.3s ease, padding 0.3s ease; /* ì „í™˜ ì• ë‹ˆë©”ì´ì…˜ ì¶”ê°€ */
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
            display: flex;
            align-items: center;
            justify-content: center;
            height: 60px; /* ê¸°ë³¸ ë†’ì´ */
            box-sizing: border-box;
            white-space: nowrap; /* í…ìŠ¤íŠ¸ ì¤„ë°”ê¿ˆ ë°©ì§€ */
            overflow: hidden; /* ë„˜ì¹˜ëŠ” í…ìŠ¤íŠ¸ ìˆ¨ê¹€ */
            text-overflow: ellipsis; /* ë„˜ì¹˜ëŠ” í…ìŠ¤íŠ¸ ... ì²˜ë¦¬ */
        }

        .theme-item:hover {
            background-color: var(--theme-item-hover-color, #cce9f0); /* í…Œë§ˆ ìƒ‰ìƒ ë³€ìˆ˜ ì‚¬ìš© */
            transform: translateX(5px);
        }

        /* ìŠ¤í¬ë¡¤ ìœ„ì¹˜ì— ë”°ë¥¸ ì•„ì´í…œ í¬ê¸° ì¡°ì ˆ */
        /* ì´ ë¶€ë¶„ì€ JavaScriptì—ì„œ ë™ì ìœ¼ë¡œ í´ë˜ìŠ¤ë¥¼ ì¶”ê°€/ì œê±°í•  ë•Œ í™œìš©ë©ë‹ˆë‹¤. */
        .theme-item.small {
            font-size: 16px; /* ì‘ê²Œ */
            padding: 10px;
            height: 50px;
            opacity: 0.7;
        }

        .theme-item.medium {
            font-size: 20px; /* ì¤‘ê°„ í¬ê¸° (ê¸°ë³¸ê°’) */
            padding: 15px;
            height: 60px;
            opacity: 1;
        }

        .theme-item.large {
            font-size: 24px; /* í¬ê²Œ */
            padding: 20px;
            height: 70px;
            opacity: 1;
            font-weight: bold;
        }

        /* íŒì—… ì˜¤ë²„ë ˆì´ì— ê°ê°ì˜ íŒì—… ì»¨í…ì¸ ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ìˆ¨ê¹€/ë³´ì´ê²Œ í•¨ */
        #number-popup .popup-content { display: block; }
        #theme-popup .theme-popup-content { display: block; }

        /* show í´ë˜ìŠ¤ê°€ ì—†ì„ ë•Œ ìˆ¨ê¹€ ì²˜ë¦¬ */
        #number-popup:not(.show) .popup-content { display: none; }
        #theme-popup:not(.show) .theme-popup-content { display: none; }

    </style>
</head>
<body>

    <h1>âœ¨ ë§ˆë²•ì˜ 3x3 ë²„íŠ¼ âœ¨</h1>

    <div class="grid">
        </div>

    <button class="theme-button" id="openThemePopupButton">ğŸ¨ í…Œë§ˆ ì„ íƒí•˜ê¸° ğŸ¨</button>

    <div id="number-popup" class="popup-overlay">
        <div class="popup-content">
            <span class="close-btn">&times;</span>
            <h2 id="popup-title"></h2>
            <p id="popup-text"></p>
        </div>
    </div>

    <div id="theme-popup" class="popup-overlay">
        <div class="theme-popup-content">
            <span class="close-btn" id="closeThemePopupButton">&times;</span>
            <h2>í…Œë§ˆë¥¼ ì„ íƒí•˜ì„¸ìš”!</h2>
            <div class="theme-scroll-container">
                </div>
        </div>
    </div>

    <script>
        // íŒì—… ë‚´ìš© ë°ì´í„° (ê¸°ì¡´)
        const popupContents = {
            1: "ğŸ• í”¼ìì— íŒŒì¸ì• í”Œì€ ì–´ë•Œ?",
            2: "ğŸ® ì˜¤ëŠ˜ì˜ ê²Œì„ì€ ë§ˆë¦¬ì˜¤ì¹´íŠ¸",
            3: "ğŸš€ ë„ˆì˜ ê¿ˆì€ ìš°ì£¼ë¡œ!",
            4: "ğŸ“š ì½”ë”©ë„ ì˜ˆìˆ ì´ì•¼",
            5: "ğŸŒˆ ë¬´ì§€ê°œëŠ” ë¹„ ì˜¨ ë’¤ì—",
            6: "ğŸ§ƒ ë”¸ê¸°ìš°ìœ ê°€ ìµœê³ ì•¼",
            7: "ğŸ¨ ë„ˆë§Œì˜ ìƒ‰ì„ ì¹ í•´ë´",
            8: "ğŸ›¸ ì™¸ê³„ì¸ ì¹œêµ¬ë¥¼ ì‚¬ê·€ì—ˆì–´",
            9: "ğŸ§¸ ê·€ì—¬ì›€ì´ ì„¸ìƒì„ êµ¬í•œë‹¤"
        };

        // í…Œë§ˆ ì„¤ì • ë°ì´í„° (ìƒ‰ìƒ ë³€ìˆ˜, ì´ëª¨ì§€, ê¸°ë³¸ ìƒíƒœ)
        const themes = [
            {
                name: "ê¸°ë³¸ í…Œë§ˆ",
                emoji: "âœ¨",
                styles: {
                    '--bg-color': '#f0f0f0',
                    '--heading-color': '#003566',
                    '--button-color': '#74c0fc',
                    '--button-hover-color': '#4da6ed',
                    '--button-active-color': '#2b7bc0',
                    '--button-text-color': '#fff',
                    '--theme-button-color': '#fca311',
                    '--theme-button-hover-color': '#fb8b24',
                    '--theme-button-active-color': '#e57100',
                    '--theme-button-text-color': '#fff',
                    '--popup-bg-color': '#fff',
                    '--popup-heading-color': '#003566',
                    '--theme-item-bg-color': '#e0f2f7',
                    '--theme-item-hover-color': '#cce9f0',
                    '--theme-item-text-color': '#003566',
                    '--scrollbar-track-color': '#f1f1f1',
                    '--scrollbar-thumb-color': '#888',
                    '--scrollbar-thumb-hover-color': '#555'
                }
            },
            {
                name: "ìƒˆë²½ ì•ˆê°œ í…Œë§ˆ",
                emoji: "ğŸŒ«ï¸",
                styles: {
                    '--bg-color': '#e0e7e9',
                    '--heading-color': '#4a6b72',
                    '--button-color': '#8cb1bb',
                    '--button-hover-color': '#6c96a3',
                    '--button-active-color': '#527c8a',
                    '--button-text-color': '#fff',
                    '--theme-button-color': '#5d7f87',
                    '--theme-button-hover-color': '#4a6b72',
                    '--theme-button-active-color': '#3b5258',
                    '--theme-button-text-color': '#fff',
                    '--popup-bg-color': '#f2f5f6',
                    '--popup-heading-color': '#4a6b72',
                    '--theme-item-bg-color': '#cfe0e5',
                    '--theme-item-hover-color': '#b6d2da',
                    '--theme-item-text-color': '#4a6b72',
                    '--scrollbar-track-color': '#e0e7e9',
                    '--scrollbar-thumb-color': '#9faab0',
                    '--scrollbar-thumb-hover-color': '#7f8a90'
                }
            },
            {
                name: "ì„ì–‘ í…Œë§ˆ",
                emoji: "ğŸŒ…",
                styles: {
                    '--bg-color': '#fde2e4',
                    '--heading-color': '#9e2a2b',
                    '--button-color': '#ffbe0b',
                    '--button-hover-color': '#fb8b24',
                    '--button-active-color': '#d96e00',
                    '--button-text-color': '#fff',
                    '--theme-button-color': '#e0573e',
                    '--theme-button-hover-color': '#c7442c',
                    '--theme-button-active-color': '#ab3723',
                    '--theme-button-text-color': '#fff',
                    '--popup-bg-color': '#fff5d7',
                    '--popup-heading-color': '#9e2a2b',
                    '--theme-item-bg-color': '#ffd9a0',
                    '--theme-item-hover-color': '#ffc060',
                    '--theme-item-text-color': '#9e2a2b',
                    '--scrollbar-track-color': '#fde2e4',
                    '--scrollbar-thumb-color': '#f9a170',
                    '--scrollbar-thumb-hover-color': '#e27b40'
                }
            },
            {
                name: "ë°¤í•˜ëŠ˜ í…Œë§ˆ",
                emoji: "ğŸŒŒ",
                styles: {
                    '--bg-color': '#212a3e',
                    '--heading-color': '#e0e0e0',
                    '--button-color': '#4a6b7e',
                    '--button-hover-color': '#6e93a7',
                    '--button-active-color': '#335063',
                    '--button-text-color': '#fff',
                    '--theme-button-color': '#7e5a8f',
                    '--theme-button-hover-color': '#9f7db3',
                    '--theme-button-active-color': '#6c4b7c',
                    '--theme-button-text-color': '#fff',
                    '--popup-bg-color': '#394867',
                    '--popup-heading-color': '#e0e0e0',
                    '--theme-item-bg-color': '#5a6e81',
                    '--theme-item-hover-color': '#6e859b',
                    '--theme-item-text-color': '#e0e0e0',
                    '--scrollbar-track-color': '#212a3e',
                    '--scrollbar-thumb-color': '#a1a9b9',
                    '--scrollbar-thumb-hover-color': '#7e879a'
                }
            },
            {
                name: "í‘¸ë¥¸ ìˆ² í…Œë§ˆ",
                emoji: "ğŸŒ³",
                styles: {
                    '--bg-color': '#e8f6ef',
                    '--heading-color': '#2a5b4f',
                    '--button-color': '#60a3bc',
                    '--button-hover-color': '#4c89a0',
                    '--button-active-color': '#3a728b',
                    '--button-text-color': '#fff',
                    '--theme-button-color': '#4c7c4c',
                    '--theme-button-hover-color': '#3a663a',
                    '--theme-button-active-color': '#2b502b',
                    '--theme-button-text-color': '#fff',
                    '--popup-bg-color': '#f0fbf5',
                    '--popup-heading-color': '#2a5b4f',
                    '--theme-item-bg-color': '#a7d9c8',
                    '--theme-item-hover-color': '#90c6b1',
                    '--theme-item-text-color': '#2a5b4f',
                    '--scrollbar-track-color': '#e8f6ef',
                    '--scrollbar-thumb-color': '#80a89a',
                    '--scrollbar-thumb-hover-color': '#668b7e'
                }
            }
            // ì—¬ê¸°ì— ë” ë§ì€ í…Œë§ˆë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆì–´ìš”!
        ];

        // DOM ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°
        const numberPopupOverlay = document.getElementById("number-popup");
        const themePopupOverlay = document.getElementById("theme-popup");
        const popupTitle = document.getElementById("popup-title");
        const popupText = document.getElementById("popup-text");
        const gridContainer = document.querySelector(".grid");
        const themeButton = document.getElementById("openThemePopupButton");
        const themeScrollContainer = document.querySelector(".theme-scroll-container");

        // ë‹«ê¸° ë²„íŠ¼ë“¤
        const closeNumberPopupButton = numberPopupOverlay.querySelector(".close-btn");
        const closeThemePopupButton = themePopupOverlay.querySelector(".close-btn");


        // --- ìˆ«ì íŒì—… ê´€ë ¨ í•¨ìˆ˜ ---
        function initializeGrid() {
            for (let i = 1; i <= 9; i++) {
                const cell = document.createElement("div");
                cell.classList.add("cell");
                cell.textContent = i;
                cell.dataset.number = i;
                gridContainer.appendChild(cell);
            }
        }

        function openNumberPopup(number) {
            popupTitle.textContent = `ë²„íŠ¼ ${number}`;
            popupText.textContent = popupContents[number];
            numberPopupOverlay.classList.add("show");
            document.body.style.overflow = 'hidden';
        }

        function closeNumberPopup() {
            numberPopupOverlay.classList.remove("show");
            document.body.style.overflow = '';
        }


        // --- í…Œë§ˆ íŒì—… ê´€ë ¨ í•¨ìˆ˜ ---
        function initializeThemeItems() {
            themeScrollContainer.innerHTML = ''; // ê¸°ì¡´ ì•„ì´í…œ ì´ˆê¸°í™”
            themes.forEach((theme, index) => {
                const themeItem = document.createElement("div");
                themeItem.classList.add("theme-item");
                themeItem.textContent = `${theme.emoji} ${theme.name}`; // ì´ëª¨ì§€ ì¶”ê°€
                themeItem.dataset.themeIndex = index;
                themeScrollContainer.appendChild(themeItem);
            });
            // ì´ˆê¸° ìŠ¤í¬ë¡¤ ìœ„ì¹˜ì— ë”°ë¼ í¬ê¸° ì¡°ì ˆ
            updateThemeItemSizes();
        }

        function openThemePopup() {
            themePopupOverlay.classList.add("show");
            document.body.style.overflow = 'hidden';
            // íŒì—…ì´ ì—´ë¦° í›„, ìŠ¤í¬ë¡¤ ìœ„ì¹˜ë¥¼ 0ìœ¼ë¡œ ì´ˆê¸°í™”
            themeScrollContainer.scrollTop = 0;
            // íŒì—…ì´ ì—´ë¦° í›„ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ì— ë”°ë¼ í¬ê¸° ì—…ë°ì´íŠ¸
            // transition ë•Œë¬¸ì— ì•½ê°„ì˜ ë”œë ˆì´ë¥¼ ì¤ë‹ˆë‹¤.
            setTimeout(updateThemeItemSizes, 300);
        }

        function closeThemePopup() {
            themePopupOverlay.classList.remove("show");
            document.body.style.overflow = '';
        }

        // ìŠ¤í¬ë¡¤ ìœ„ì¹˜ì— ë”°ë¼ í…Œë§ˆ ì•„ì´í…œ í¬ê¸° ì¡°ì ˆ í•¨ìˆ˜
        function updateThemeItemSizes() {
            const containerHeight = themeScrollContainer.clientHeight;
            const scrollTop = themeScrollContainer.scrollTop;
            const items = themeScrollContainer.querySelectorAll('.theme-item');

            items.forEach(item => {
                const itemTop = item.offsetTop - scrollTop;
                const itemBottom = itemTop + item.offsetHeight;
                const itemCenter = itemTop + item.offsetHeight / 2;

                // ì»¨í…Œì´ë„ˆ ì¤‘ì•™ Y ì¢Œí‘œ (ìŠ¤í¬ë¡¤ë°” í¬í•¨)
                const containerCenterY = containerHeight / 2;

                // ì•„ì´í…œì´ ì»¨í…Œì´ë„ˆ ì¤‘ì•™ì— ì–¼ë§ˆë‚˜ ê°€ê¹Œìš´ì§€ ê³„ì‚°
                const distanceToCenter = Math.abs(itemCenter - containerCenterY);

                // ìµœëŒ€ ê±°ë¦¬ëŠ” ì»¨í…Œì´ë„ˆ ë†’ì´ì˜ ì ˆë°˜
                const maxDistance = containerHeight / 2;

                // ê±°ë¦¬ê°€ ë©€ìˆ˜ë¡ ì‘ì•„ì§€ê³ , ê°€ê¹Œìš¸ìˆ˜ë¡ ì»¤ì§€ë„ë¡ ìŠ¤ì¼€ì¼ ê³„ì‚°
                // 1 (ê°€ì¥ í¼) ~ 0.6 (ê°€ì¥ ì‘ìŒ)
                let scale = 1 - (distanceToCenter / maxDistance) * 0.4; // 0.4ëŠ” ì¡°ì ˆ ê°€ëŠ¥í•œ ìŠ¤ì¼€ì¼ í­
                scale = Math.max(0.7, Math.min(1, scale)); // ìµœì†Œ 0.7ë°°, ìµœëŒ€ 1ë°°ë¡œ ì œí•œ

                if (scale >= 0.9) {
                    item.classList.remove('small', 'medium');
                    item.classList.add('large');
                } else if (scale >= 0.8) {
                    item.classList.remove('small', 'large');
                    item.classList.add('medium');
                } else {
                    item.classList.remove('medium', 'large');
                    item.classList.add('small');
                }
            });
        }


        // ì„ íƒëœ í…Œë§ˆë¥¼ ì ìš©í•˜ëŠ” í•¨ìˆ˜
        function applyTheme(themeIndex) {
            const selectedTheme = themes[themeIndex];
            if (!selectedTheme) return;

            const root = document.documentElement; // HTMLì˜ root ìš”ì†Œ
            // CSS ë³€ìˆ˜ ì—…ë°ì´íŠ¸
            for (const [property, value] of Object.entries(selectedTheme.styles)) {
                root.style.setProperty(property, value);
            }

            // í…Œë§ˆ ë²„íŠ¼ í…ìŠ¤íŠ¸ì™€ ì´ëª¨ì§€ ì—…ë°ì´íŠ¸ (ì„ íƒëœ í…Œë§ˆë¡œ)
            themeButton.innerHTML = `${selectedTheme.emoji} ${selectedTheme.name}`;

            console.log(`í…Œë§ˆê°€ "${selectedTheme.name}"ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤!`);
            closeThemePopup();
        }

        // --- ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡ ---
        gridContainer.addEventListener("click", (event) => {
            const targetCell = event.target.closest(".cell");
            if (targetCell) {
                const number = parseInt(targetCell.dataset.number);
                openNumberPopup(number);
            }
        });

        closeNumberPopupButton.addEventListener("click", closeNumberPopup);

        numberPopupOverlay.addEventListener("click", (event) => {
            if (event.target === numberPopupOverlay) {
                closeNumberPopup();
            }
        });

        themeButton.addEventListener("click", openThemePopup);

        closeThemePopupButton.addEventListener("click", closeThemePopup);

        themePopupOverlay.addEventListener("click", (event) => {
            if (event.target === themePopupOverlay) {
                closeThemePopup();
            }
        });

        // í…Œë§ˆ ì•„ì´í…œ í´ë¦­ ì´ë²¤íŠ¸ (ì´ë²¤íŠ¸ ìœ„ì„)
        themeScrollContainer.addEventListener("click", (event) => {
            const clickedThemeItem = event.target.closest(".theme-item");
            if (clickedThemeItem) {
                const themeIndex = parseInt(clickedThemeItem.dataset.themeIndex);
                applyTheme(themeIndex); // í…Œë§ˆ ì ìš© í•¨ìˆ˜ í˜¸ì¶œ
            }
        });

        // ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ ë°œìƒ ì‹œ í…Œë§ˆ ì•„ì´í…œ í¬ê¸° ì—…ë°ì´íŠ¸
        themeScrollContainer.addEventListener('scroll', updateThemeItemSizes);

        document.addEventListener("keydown", (event) => {
            if (event.key === "Escape") {
                if (numberPopupOverlay.classList.contains("show")) {
                    closeNumberPopup();
                } else if (themePopupOverlay.classList.contains("show")) {
                    closeThemePopup();
                }
            }
        });

        document.addEventListener("DOMContentLoaded", () => {
            initializeGrid();
            initializeThemeItems();
            applyTheme(0); // í˜ì´ì§€ ë¡œë“œ ì‹œ 'ê¸°ë³¸ í…Œë§ˆ' ì ìš©
        });
    </script>

</body>
</html>
